{% extends "layout.html" %}


{% block content %}

<ul class="nav nav-tabs">
  <li {% if not adv_search %} class="active"{% endif %}><a href="#keyword" data-toggle="tab">Keyword</a></li>
  <li {% if adv_search %} class="active"{% endif %}><a href="#advanced" data-toggle="tab">Advanced</a></li>
</ul>

<div class="tab-content">
  <div class="tab-pane {% if not adv_search %} active{% endif %}" id="keyword">
          <p>
    <form  method="get" name="search">
              <input name="keyword" size="80" type="text" value="{{ request.args.get('keyword', '') }}" placeholder="Keyword search term">
              <input type="submit" value="Search">
    </form>
          </p>
  </div>
  <div class="tab-pane form-horizontal {% if  adv_search %} active{% endif %}" id="advanced">
    <form  method="get" name="search">
          <div class="form-group">
            <label for="keyword" class="col-sm-2 control-label">Keyword</label>
            <div class="col-sm-4">
              <input class="form-control" name="keyword" value="{{ request.args.get('keyword', '') }}" placeholder="Enter keyword">
            </div>
            <label for="title" class="col-sm-2 control-label">Title</label>
            <div class="col-sm-4">
              <input class="form-control" name="title" placeholder="Enter title">
            </div>
          </div>

          <div class="form-group">
            <label for="period" class="col-sm-2 control-label">Period</label>
            <div class="col-sm-4">
              <input class="form-control" name="period" placeholder="Enter period">
            </div>
            <label for="address" class="col-sm-2 control-label">Address</label>
            <div class="col-sm-4">
              <input class="form-control" name="address" value="{{ request.args.get('address', '') }}" placeholder="Enter Address">
            </div>
          </div>

          <div class="form-group">
            <label for="building_type" class="col-sm-2 control-label">Building Type</label>
            <div class="col-sm-4">
              <input class="form-control" name="building_type" placeholder="Enter building type">
            </div>
            <label for="creator" class="col-sm-2 control-label">Creator</label>
            <div class="col-sm-4">
              <input class="form-control" name="creator" value="{{ request.args.get('creator', '') }}"  placeholder="Enter creator">
            </div>
          </div>

          <div class="form-group">
            <label for="style" class="col-sm-2 control-label">Style</label>
            <div class="col-sm-4">
              <input class="form-control" name="style" placeholder="Enter style">
            </div>
            <label for="description" class="col-sm-2 control-label">Description</label>
            <div class="col-sm-4">
              <input class="form-control" name="description" placeholder="Enter description">
            </div>
          </div>

          <div class="form-group">
            <div class="col-sm-2 col-md-offset-8">
              <input type="submit" value="Search">
            </div>
          </div>
    </form>
</div>

<div class="row">
    <div class="col-md-10">
    </div>
</div>
<div class="row">
    <div class="col-md-10">
    </div>
</div>



<div class="row">
    <div class="col-md-3 facets">
{% set shown_facets = [
    ('Suburb', 'addresses.suburb', 'title'),
    ('State', 'state', 'upper'),
    ('Architect', 'architects.raw', 'title')
] -%}
        {% for title, facet, case in shown_facets %}
          <b>{{title}}</b><br>
          <ol>
            {% for term in facets[facet].terms %}
                {% if case == 'title' %}
                    <li>{{ term.term|title }} ({{ term.count }})</li>
                {% elif case == 'upper' %}
                    <li>{{ term.term|upper }} ({{ term.count }})</li>
                {% else %}
                    <li>{{ term.term }} ({{ term.count }})</li>
                {% endif %}
            {% endfor %}
          </ol>
        {% endfor %}
    </div>


    <div class="col-md-9 results">

        {{ pagination.info|safe }}
        <ol>
        {% for hit in results %}
        <li>
                <b><a href="{{ url_for('get_record', id=hit._id) }}">[{{ hit._source.state }}] {{ hit._source.name|title }}</a></b>
                 - <a href="{{ hit._source.url }}">Source record</a>
                 <!-- - <a href="{{ url_for('get_record_json', id=hit._id) }}">json</a> -->
                 <br>
                 {% with address = hit._source.addresses|first %}
                    {% if address %}
                        <div class="address">{{address.lga_name|title if address.lga_name}}, {{address.state}}{{', ' ~ address.postcode if address.postcode}}</div>
                    {% endif %}
                 {% endwith %}

        </li>
        {% endfor %}
        </ol>

        {{ pagination.links|safe }}
    </div>
</div>


{% endblock %}